function songDownloadClicked(n){var t=$(n).attr("rel");$(n).text("0 %");port.postMessage({method:"download",songId:t})}var s=document.createElement("script"),port;s.src=chrome.extension.getURL("Scripts/page.min.js");s.onload=function(){this.parentNode.removeChild(this)};(document.head||document.documentElement).appendChild(s);port=chrome.extension.connect({name:"msg"});document.addEventListener("DOMNodeInserted",function(n){n.stopPropagation()},!0);document.addEventListener("click",function(n){if(n.target.getAttribute("data-d")=="1")return n.stopPropagation(),songDownloadClicked(n.target),!1},!0);$(function(){function i(){for(var n="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<6;i++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}function u(){$("#page_content_pane .content #grid.songs div.ui-widget-content.slick-row,#page_content  #grid.songs div.ui-widget-content.slick-row").not(r).each(function(){var i=$(this).find("span."+n),t=$(this).find(".song a.play").first().attr("rel"),r;i.length==0?t!=null&&(i=$("<span>").text("D0wnload").addClass(n).attr("id",n+t).attr("rel",t).attr("style","float: right !important;color:#2a9914 !important;cursor:pointer;").attr("data-d","1"),r=$(this).find(".artist").first(),i.appendTo(r)):i.attr("id",n+t).attr("rel",t)});$(".content #grid .module-row.song.tall").each(function(){var i=$(this).find("span."+n),t=$(this).find(".metadata i.icon").first().attr("data-song-id"),r;t&&t!=null&&(i.length==0?(r=$(this).find(".meta-inner").first(),i=$("<span>").text("D0wnload").addClass(n).attr("id",n+t).attr("rel",t).attr("style","float: right !important;color:#2a9914 !important;cursor:pointer;").attr("data-d","1"),i.appendTo(r)):i.attr("rel")!=t&&i.text("D0wnload").attr("id",n+t).attr("rel",t).attr("style","float: right !important;color:#2a9914 !important;cursor:pointer;").attr("data-d","1"))});t($(".content #profile-grid .module-row.song"));t($(".content #grid .module-row.song").not("tall"));t($(".content #top-songs-grid .module-row.song"));t($(".content .module.module-nested.artist-album.grid-item .module-row.song"),".module-row-cell.song")}function t(t,i){$(t).each(function(){var r=$(this).find("span."+n),t=$(this).find("i.song-link").first().attr("rel"),u;t&&t!=null&&(r.length==0?(i||(i=".artist,.album"),u=$(this).find(i).first(),r=$("<span>").text("D0wnload").addClass(n).attr("id",n+t).attr("rel",t).attr("style","float: right !important;color:#2a9914 !important;cursor:pointer;").attr("data-d","1"),r.appendTo(u)):r.attr("rel")!=t&&r.text("D0wnload").attr("id",n+t).attr("rel",t).attr("style","float: right !important;color:#2a9914 !important;cursor:pointer;").attr("data-d","1"))})}function f(t,i){var r=$("#"+n+t);r.text(i+" %")}function e(t,i,r){var f=$("#"+n+t),u,e;f.attr("data-d","0");f.text(chrome.i18n.getMessage("downloadFinished"));f.attr("style","float: right !important;color:#2b2b2b !important;");f.attr("href",i);f.attr("download",r);u=document.createElement("a");u.setAttribute("href",i);u.setAttribute("download",r);document.body.appendChild(u);e=document.createEvent("MouseEvent");e.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null);u.dispatchEvent(e);setTimeout(function(){document.removeChild(u)},10)}var n=i(),r=i();port.onMessage.addListener(function(n){n.method=="updateProgress"?f(n.songId,n.progress):n.method=="downloadComplete"&&e(n.songId,n.url,n.fileName)});$("#grid.songs .slick-viewport").on("DOMNodeInserted",function(){E.stopPropagation();E.stopImmediatePropagation()});setInterval(function(){var n=document.getElementsByClassName("grid-viewport");n&&u()},150)});
/*
//# sourceMappingURL=grooveshark.min.js.map
*/